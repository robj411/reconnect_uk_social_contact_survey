install.packages('flextable')
install.packages('scoringutils')
R profile.site
Rprofile.site
install.packages('"~/Downloads/scoringutils_2.1.0.tgz"')
install.packages("~/Downloads/scoringutils_2.1.0.tgz")
library(scoringutils)
curl::has_internet
if (is.character(getURL("www.google.com"))) {
out <- TRUE
} else {
out <- FALSE
}
Sys.geten()
Sys.getenv()
install.packages('flextable')
library(flextable)
install.packages('flextable')
library(flextable)
.libPaths()
getwd()
install.packages('flextable')
install.packages('flextable', verbose = TRUE)
setInternet2(TRUE)
temp <- tempfile()
download.file("https://files.digital.nhs.uk/49/D6F2CE/child-vaccination-stats-csvs-2023-24.zip",temp)
temp <- tempfile()
download.file("http://files.digital.nhs.uk/49/D6F2CE/child-vaccination-stats-csvs-2023-24.zip",temp)
options(download.file.method="libcurl")
temp <- tempfile()
download.file("https://files.digital.nhs.uk/49/D6F2CE/child-vaccination-stats-csvs-2023-24.zip",temp)
options(repos='http://cran.rstudio.com/')
install.packages('flextable')
options(repos='https://cran.rstudio.com/')
?Startup
options(repos = c(CRAN = "https://cran.ma.imperial.ac.uk/",
CRANextra = "https://mirrors.ebi.ac.uk/CRAN/"))
install.packages("flextable")
options(repos='https://cran.rstudio.com/')
Sys.getenv()
Sys.getenv("R_PROFILE")
c( Sys.getenv("R_PROFILE"),
file.path(Sys.getenv("R_HOME"), "etc", "Rprofile.site"),
Sys.getenv("R_PROFILE_USER"),
file.path(getwd(), ".Rprofile"),
file.path(Sys.getenv("HOME"), ".Rprofile"))
candidates <- c( Sys.getenv("R_PROFILE"),
file.path(Sys.getenv("R_HOME"), "etc", "Rprofile.site"),
Sys.getenv("R_PROFILE_USER"),
file.path(getwd(), ".Rprofile"),
file.path(Sys.getenv("HOME"), ".Rprofile"))
Filter(file.exists, candidates)
file.path(Sys.getenv("HOME"), ".Rprofile")
Sys.getenv("PATH")
library(devtools)
install.libraries('"~/Downloads/devtools_2.4.5.tgz"')
install.packages("~/Downloads/devtools_2.4.5.tgz")
library(devtools)
install.packages("~/Downloads/usethis_3.1.0.tgz")
library(usethis)
lib.loc
.libPaths()
install.packages('flextable')
renv::restore()
install.packages('renv')
library(renvb)
library(renv)
temp <- tempfile()
download.file("https://files.digital.nhs.uk/49/D6F2CE/child-vaccination-stats-csvs-2023-24.zip",temp)
temp <- tempfile()
download.file("https://files.digital.nhs.uk/49/D6F2CE/child-vaccination-stats-csvs-2023-24.zip",temp)
temp <- tempfile()
download.file("https://files.digital.nhs.uk/49/D6F2CE/child-vaccination-stats-csvs-2023-24.zip",temp)
install.packages('renv')
install.packages('renv')
install.packages('renv')
library(renv)
install.packages('renv')
install.packages('renv')
install.packages('renv')
install.packages('renv')
temp <- tempfile()
download.file("https://files.digital.nhs.uk/49/D6F2CE/child-vaccination-stats-csvs-2023-24.zip",temp)
# load packages
library(data.table)
library(readr)
library(readxl)
library(tidyr, warn.conflicts = FALSE)
library(dplyr, warn.conflicts = FALSE)
library(purrr, warn.conflicts = FALSE)
library(patchwork, warn.conflicts = FALSE)
library(RColorBrewer, warn.conflicts = FALSE)
library(ggplot2)
suppressPackageStartupMessages(library(viridis, warn.conflicts = FALSE))
# set arguments
.args <- if (interactive()) c(
file.path("output", "data", "cont_matrs","fitted_matrs.csv"),
file.path("data", "census","imd_age.csv"),
file.path("output", "figures", "cont_matrs","fitted_matrs.png")
) else commandArgs(trailingOnly = TRUE)
source(here::here('scripts','run_cont_matrs','cont_matr_fcns.R'))
# load packages
library(data.table)
library(readr)
library(readxl)
library(tidyr, warn.conflicts = FALSE)
library(dplyr, warn.conflicts = FALSE)
setwd("~/Desktop/LSHTM/PhD_2528/Reconnect/reconnect_uk_social_contact_survey")
# censor any categories of participant with less than x:
censor_low_val <- 5
# right-censor total contact counts at:
max_n_contacts <- 10000 # deliberately redundant
# choose age groups for analysis
age_breaks <- c(-Inf, 5*1:(75/5), Inf)
age_vals <- age_breaks[is.finite(age_breaks)]
age_labels <- c(paste0(c(0, age_vals[1:length(age_vals)-1]), '-', c(age_vals-1)), paste0(age_vals[length(age_vals)], '+'))
library(here)
## install appropriate packages ##
source(here::here('scripts','analyses','install_packages.R'))
source(here::here('scripts','analyses','colors.R'))
## source analysis functions ##
source(here::here('scripts','analyses','functions.R'))
## negative binomial functions ##
source(here::here('scripts','analyses','negative_binom','negative_binomial_fcns.R'))
## load UK gender-specific age structure etc. ##
source(here::here('scripts','analyses','age_structure.R'))
## load data ##
reconnect_participant_common <- read_csv(here::here('data','zenodo','reconnect_participant_common.csv'), show_col_types = F)
reconnect_participant_extra <- read_csv(here::here('data','zenodo','reconnect_participant_extra.csv'), show_col_types = F)
reconnect_participant_sday <- read_csv(here::here('data','zenodo','reconnect_sday.csv'), show_col_types = F)
reconnect_participant <- left_join(reconnect_participant_common,
reconnect_participant_extra,
by = 'part_id') %>% left_join(reconnect_participant_sday, by = 'part_id')
read_csv(here::here('data','zenodo','reconnect_contact_common.csv'), show_col_types = F)
reconnect_contact_common <- read_csv(here::here('data','zenodo','reconnect_contact_common.csv'), show_col_types = F) %>%
filter(!is.na(cnt_age_exact))
reconnect_contact_extra <- read_csv(here::here('data','zenodo','reconnect_contact_extra.csv'), show_col_types = F) %>%
filter(!is.na(cnt_age_exact))
reconnect_contact_extra
read_csv(here::here('data','zenodo','reconnect_contact_extra.csv'), show_col_types = F)
reconnect_contact_extra <- read_csv(here::here('data','zenodo','reconnect_contact_extra.csv'), show_col_types = F) %>%
filter(!is.na(cnt_location))
reconnect_contact_extra <- read_csv(here::here('data','zenodo','reconnect_contact_extra.csv'), show_col_types = F) %>%
filter(!is.na(cnt_location)) # remove large group contacts
reconnect_contact <- left_join(reconnect_contact_common,
reconnect_contact_extra,
by = c('cont_id','part_id'))
reconnect_contact
socialmixr::get_survey(10.5281/zenodo.16845074)
socialmixr::get_survey('10.5281/zenodo.16845074')
reconnect <- socialmixr::get_survey('10.5281/zenodo.16845074')
contact_matrix(reconnect)
contact_matrix(reconnect, age.limits = c(0,5,10,18,30,50,65,80))
mr <- contact_matrix(reconnect, age.limits = c(0,5,10,18,30,50,65,80))
matrix_plot(mr)
matrix_plot(mr$matrix)
mr <- contact_matrix(reconnect, age.limits = c(0,5,10,18,30,50,65,80), estimated.contact.age = 'sample')
matrix_plot(mr$matrix)
mr <- contact_matrix(reconnect, age.limits = seq(0,75,by=5), estimated.contact.age = 'sample')
matrix_plot(mr$matrix)
mr <- contact_matrix(reconnect, age.limits = seq(0,75,by=5), estimated.contact.age = 'sample', weigh.age = T, weigh.dayofweek = T)
mr <- contact_matrix(reconnect, age.limits = seq(0,75,by=5), estimated.contact.age = 'sample', weigh.dayofweek = T)
matrix_plot(mr$matrix)
mr <- contact_matrix(reconnect, estimated.contact.age = 'sample', weigh.dayofweek = T)
mr
mr <- contact_matrix(reconnect, age.limits = c(90), estimated.contact.age = 'sample', weigh.dayofweek = T)
mr <- contact_matrix(reconnect, age.limits = c(0,90), estimated.contact.age = 'sample', weigh.dayofweek = T)
mr
